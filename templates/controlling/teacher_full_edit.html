{% extends "templates/base.html" %}
{% load static %}

{% block tab_id %}id="teacher_full_edit_tab"{% endblock %}

{% block extra_head %}
<meta name="robots" content="noindex">
<style>
/* Verwende das gleiche Design wie die User Views */
.mbs { 
  padding: 2rem 0; 
  background: #fdfdfd; 
  min-height: 80vh; 
}
.bs{
    height: 0 !important;
}
.form-hero { 
  background: #f8f9fa; 
  border-bottom: 3px solid #D11317; 
  padding: 2rem; 
  text-align: center; 
}

.form-title { 
  font-family: "jaf-bernina-sans-condensed", sans-serif; 
  font-size: 2.2rem; 
  font-weight: 800; 
  color: #D11317; 
  margin-bottom: 0.5rem; 
}

.form-subtitle { 
  font-family: "jaf-bernina-sans-condensed", sans-serif; 
  font-size: 1rem; 
  color: #666; 
  font-weight: 500; 
}

.form-card { 
  background: white; 
  border: 1px solid #e0e0e0; 
  border-radius: 12px; 
  padding: 2rem; 
  margin: 2rem auto; 
  max-width: 900px; 
  box-shadow: 0 2px 8px rgba(0,0,0,0.05); 
}

.form-section {
  margin-bottom: 2.5rem;
  padding-bottom: 2rem;
  border-bottom: 1px solid #f0f0f0;
}

.form-section:last-child {
  border-bottom: none;
  padding-bottom: 0;
  margin-bottom: 0;
}

.section-title {
  font-family: "jaf-bernina-sans-condensed", sans-serif;
  font-size: 1.4rem;
  font-weight: 700;
  color: #D11317;
  margin-bottom: 1.5rem;
  padding-bottom: 0.5rem;
  border-bottom: 2px solid #f0f0f0;
}

.form-row {
  display: grid;
  grid-template-columns: 1fr 1fr;
  gap: 1.5rem;
  margin-bottom: 1.5rem;
}

.form-row-single {
  display: grid;
  grid-template-columns: 1fr;
  margin-bottom: 1.5rem;
}

.form-group { 
  margin-bottom: 1.5rem; 
}

.form-label { 
  display: block; 
  font-weight: 600; 
  color: #333; 
  margin-bottom: 0.5rem; 
  font-size: 0.95rem; 
}

.form-control { 
  width: 100%; 
  padding: 0.8rem; 
  border: 1px solid #ddd; 
  border-radius: 6px; 
  font-size: 0.95rem; 
  transition: border-color 0.3s ease; 
  font-family: "jaf-bernina-sans-condensed", sans-serif;
}

.form-control:focus { 
  outline: none; 
  border-color: #D11317; 
  box-shadow: 0 0 0 2px rgba(209, 19, 23, 0.1); 
}

.form-select { 
  width: 100%; 
  padding: 0.8rem; 
  border: 1px solid #ddd; 
  border-radius: 6px; 
  font-size: 0.95rem; 
  background: white; 
  font-family: "jaf-bernina-sans-condensed", sans-serif;
}

.form-textarea {
  width: 100%;
  padding: 0.8rem;
  border: 1px solid #ddd;
  border-radius: 6px;
  font-size: 0.95rem;
  font-family: "jaf-bernina-sans-condensed", sans-serif;
  resize: vertical;
  min-height: 120px;
}

.checkbox-section {
  background: #f8f9fa;
  border: 1px solid #e9ecef;
  border-radius: 8px;
  padding: 1.5rem;
  margin-bottom: 1.5rem;
}

.checkbox-grid { 
  display: grid; 
  grid-template-columns: repeat(auto-fit, minmax(280px, 1fr)); 
  gap: 1rem; 
  margin-top: 1rem;
}

.checkbox-item { 
  display: flex; 
  align-items: center; 
  gap: 0.5rem; 
  padding: 0.5rem;
  background: white;
  border-radius: 6px;
  border: 1px solid #e9ecef;
  transition: all 0.2s ease;
}

.checkbox-item:hover {
  background: #f8f9fa;
  border-color: #D11317;
}

.checkbox-item input[type="checkbox"] { 
  width: 18px; 
  height: 18px; 
  accent-color: #D11317; 
  margin: 0;
}

.checkbox-item label { 
  font-size: 0.9rem; 
  color: #555; 
  margin: 0; 
  cursor: pointer; 
  flex: 1;
}

.coordinator-toggle {
  background: linear-gradient(135deg, #D11317 0%, #b10e13 100%);
  color: white;
  padding: 1rem;
  border-radius: 8px;
  margin-bottom: 1rem;
}

.coordinator-toggle .checkbox-item {
  background: transparent;
  border: 1px solid rgba(255,255,255,0.3);
  color: white;
}

.coordinator-toggle .checkbox-item label {
  color: white;
  font-weight: 600;
}

.coordinator-subjects {
  transition: all 0.3s ease;
}

.coordinator-subjects.inactive {
  opacity: 0.5;
  pointer-events: none;
}

.form-hint {
  font-size: 0.85rem;
  color: #6b7280;
  margin-top: 0.5rem;
  font-style: italic;
}

.form-actions { 
  display: flex; 
  gap: 1rem; 
  justify-content: space-between; 
  align-items: center;
  margin-top: 2rem; 
  padding-top: 2rem; 
  border-top: 2px solid #f0f0f0;
}

.btn-group {
  display: flex;
  gap: 1rem;
}

.btn { 
  padding: 0.8rem 1.5rem; 
  border: none; 
  border-radius: 6px; 
  font-weight: 600; 
  font-size: 0.95rem; 
  cursor: pointer; 
  transition: all 0.3s ease; 
  text-decoration: none; 
  display: inline-flex; 
  align-items: center; 
  gap: 0.5rem; 
  font-family: "jaf-bernina-sans-condensed", sans-serif;
}

.btn-primary { 
  background: #D11317; 
  color: white; 
}

.btn-primary:hover { 
  background: #b10e13; 
  color: white; 
  text-decoration: none; 
  transform: translateY(-1px);
  box-shadow: 0 4px 12px rgba(209, 19, 23, 0.3);
}

.btn-secondary { 
  background: #6c757d; 
  color: white; 
}

.btn-secondary:hover { 
  background: #545b62; 
  color: white; 
  text-decoration: none; 
  transform: translateY(-1px);
}

.btn-danger {
  background: #dc2626;
  color: white;
}

.btn-danger:hover {
  background: #b91c1c;
  color: white;
  text-decoration: none;
  transform: translateY(-1px);
  box-shadow: 0 4px 12px rgba(220, 38, 38, 0.3);
}

.alert { 
  padding: 1rem; 
  border-radius: 6px; 
  margin-bottom: 1rem; 
}

.alert-success { 
  background: #d4edda; 
  color: #155724; 
  border: 1px solid #c3e6cb; 
}

.alert-error { 
  background: #f8d7da; 
  color: #721c24; 
  border: 1px solid #f5c6cb; 
}

.required-asterisk {
  color: #D11317;
  font-weight: bold;
}

.status-indicator {
  display: inline-flex;
  align-items: center;
  gap: 0.5rem;
  font-size: 0.9rem;
  padding: 0.5rem 1rem;
  border-radius: 6px;
  background: #f8f9fa;
  border: 1px solid #e9ecef;
  margin-bottom: 1rem;
}

.status-indicator.active {
  background: #d4edda;
  border-color: #c3e6cb;
  color: #155724;
}

/* Responsive Design */
@media (max-width: 768px) { 
  .mbs { 
    padding: 1rem 0; 
  } 
  
  .form-card { 
    margin: 1rem; 
    padding: 1.5rem; 
  } 
  
  .form-row {
    grid-template-columns: 1fr;
    gap: 1rem;
  }
  
  .checkbox-grid {
    grid-template-columns: 1fr;
  }
  
  .form-actions { 
    flex-direction: column; 
    gap: 1rem;
  }
  
  .btn-group {
    flex-direction: column;
    width: 100%;
  }
  
  .btn {
    justify-content: center;
  }
}

@media (max-width: 480px) {
  .form-title {
    font-size: 1.8rem;
  }
  
  .section-title {
    font-size: 1.2rem;
  }
  
  .checkbox-item {
    flex-direction: column;
    align-items: flex-start;
    gap: 0.75rem;
    padding: 0.75rem;
  }
  
  .checkbox-item input[type="checkbox"] {
    order: -1;
  }
}
</style>
{% endblock %}

{% block navbar %}{% endblock %}

{% block body %}
<div class="form-hero">
  <h1 class="form-title">Lehrer bearbeiten</h1>
  <p class="form-subtitle">{{ teacher.first_name }} {{ teacher.last_name }} - Vollständige Bearbeitung</p>
</div>

<div class="form-card">
      {% if messages %}
        {% for message in messages %}
          <div class="alert alert-{{ message.tags }}">{{ message }}</div>
        {% endfor %}
      {% endif %}

      <form method="post" id="teacher-form">
        {% csrf_token %}
        
        <!-- Persönliche Daten -->
        <div class="form-section">
          <h3 class="section-title">
            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" style="margin-right: 0.5rem;">
              <path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
              <circle cx="12" cy="7" r="4" stroke="currentColor" stroke-width="2"/>
            </svg>
            Persönliche Daten
          </h3>
          
          <div class="form-row">
            <div class="form-group">
              <label class="form-label" for="first_name">
                Vorname <span class="required-asterisk">*</span>
              </label>
              <input type="text" name="first_name" id="first_name" class="form-control" value="{{ teacher.first_name }}" required>
            </div>
            
            <div class="form-group">
              <label class="form-label" for="last_name">
                Nachname <span class="required-asterisk">*</span>
              </label>
              <input type="text" name="last_name" id="last_name" class="form-control" value="{{ teacher.last_name }}" required>
            </div>
          </div>
          
          <div class="form-row">
            <div class="form-group">
              <label class="form-label" for="academic_title">Akademischer Titel</label>
              <select name="academic_title" id="academic_title" class="form-select">
                <option value="">Kein Titel</option>
                {% for title in academic_titles %}
                <option value="{{ title.id }}" {% if teacher.academic_title.id == title.id %}selected{% endif %}>
                  {{ title.title }}
                </option>
                {% endfor %}
              </select>
            </div>
            
            <div class="form-group">
              <label class="form-label" for="gender">Geschlecht</label>
              <select name="gender" id="gender" class="form-select">
                {% for gender in genders %}
                <option value="{{ gender.id }}" {% if teacher.gender.id == gender.id %}selected{% endif %}>
                  {{ gender.gender }}
                </option>
                {% endfor %}
              </select>
            </div>
          </div>
        </div>
        
        <!-- Kontaktdaten -->
        <div class="form-section">
          <h3 class="section-title">
            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" style="margin-right: 0.5rem;">
              <path d="M4 4h16c1.1 0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1 0-2-.9-2-2V6c0-1.1.9-2 2-2z" stroke="currentColor" stroke-width="2"/>
              <polyline points="22,6 12,13 2,6" stroke="currentColor" stroke-width="2"/>
            </svg>
            Kontaktdaten
          </h3>
          
          <div class="form-row">
            <div class="form-group">
              <label class="form-label" for="email">E-Mail-Adresse</label>
              <input type="email" name="email" id="email" class="form-control" value="{{ teacher.email }}">
            </div>
            
            <div class="form-group">
              <label class="form-label" for="phone">Telefonnummer</label>
              <input type="text" name="phone" id="phone" class="form-control" value="{{ teacher.phone }}">
            </div>
          </div>
          
          <div class="form-row-single">
            <div class="form-group">
              <label class="form-label" for="homepage">Website</label>
              <input type="url" name="homepage" id="homepage" class="form-control" value="{{ teacher.homepage }}" placeholder="https://example.com">
            </div>
          </div>
        </div>
        
        <!-- Unterrichtsfächer -->
        <div class="form-section">
          <h3 class="section-title">
            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" style="margin-right: 0.5rem;">
              <path d="M2 3h6a4 4 0 0 1 4 4v14a3 3 0 0 0-3-3H2z" stroke="currentColor" stroke-width="2"/>
              <path d="M22 3h-6a4 4 0 0 0-4 4v14a3 3 0 0 1 3-3h7z" stroke="currentColor" stroke-width="2"/>
            </svg>
            Unterrichtsfächer
          </h3>
          
          <div class="checkbox-section">
            <div class="form-hint">Wählen Sie alle Fächer aus, die dieser Lehrer unterrichtet:</div>
            <div class="checkbox-grid">
              {% for subject in all_subjects %}
              <div class="checkbox-item">
                <input type="checkbox" 
                       name="subjects" 
                       value="{{ subject.id }}" 
                       id="subject_{{ subject.id }}"
                       {% if subject in teacher.subject.all %}checked{% endif %}>
                <label for="subject_{{ subject.id }}">
                  {{ subject.subject }}
                </label>
              </div>
              {% endfor %}
            </div>
          </div>
        </div>
        
        <!-- Fachbereichsleitung -->
        <div class="form-section">
          <h3 class="section-title">
            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" style="margin-right: 0.5rem;">
              <path d="M9 12l2 2 4-4" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
              <path d="M21 12c.552 0 1-.448 1-1V5c0-.552-.448-1-1-1H3c-.552 0-1 .448-1 1v6c0 .552.448 1 1 1" stroke="currentColor" stroke-width="2"/>
              <path d="M3 12v6c0 .552.448 1 1 1h16c.552 0 1-.448 1-1v-6" stroke="currentColor" stroke-width="2"/>
            </svg>
            Fachbereichsleitung
          </h3>
          
          <div class="coordinator-toggle">
            <div class="checkbox-item">
              <input type="checkbox" 
                     name="subject_coordinator_active" 
                     value="1" 
                     id="coordinator_active"
                     {% if teacher.subject_coordinator_active %}checked{% endif %}>
              <label for="coordinator_active">
                <strong>Fachgruppenleitung ist aktiv</strong>
              </label>
            </div>
            <div class="form-hint" style="color: rgba(255,255,255,0.8); margin-top: 0.5rem;">
              Aktivieren Sie diese Option, wenn der Lehrer als Fachgruppenleiter fungiert
            </div>
          </div>
          
          <div class="checkbox-section coordinator-subjects" id="coordinator-subjects" {% if not teacher.subject_coordinator_active %}style="opacity: 0.5; pointer-events: none;"{% endif %}>
            <div class="status-indicator {% if teacher.subject_coordinator_active %}active{% endif %}">
              <svg width="16" height="16" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                <circle cx="12" cy="12" r="10" stroke="currentColor" stroke-width="2"/>
                <polyline points="9,12 12,15 16,10" stroke="currentColor" stroke-width="2"/>
              </svg>
              {% if teacher.subject_coordinator_active %}
                Fachbereichsleitung aktiv
              {% else %}
                Fachbereichsleitung inaktiv
              {% endif %}
            </div>
            
            <div class="form-hint">Fachbereiche, für die der Lehrer verantwortlich ist:</div>
            <div class="checkbox-grid">
              {% for category in subject_categories %}
              <div class="checkbox-item">
                <input type="checkbox" 
                       name="subject_coordinators" 
                       value="{{ category.id }}" 
                       id="coordinator_{{ category.id }}"
                       class="coordinator-subject"
                       {% if category in teacher.subject_coordinator.all %}checked{% endif %}>
                <label for="coordinator_{{ category.id }}">
                  {{ category.name }}
                </label>
              </div>
              {% endfor %}
            </div>
          </div>
        </div>
        
        <!-- Adresse -->
        <div class="form-section">
          <h3 class="section-title">
            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" style="margin-right: 0.5rem;">
              <path d="M21 10c0 7-9 13-9 13s-9-6-9-13a9 9 0 0 1 18 0z" stroke="currentColor" stroke-width="2"/>
              <circle cx="12" cy="10" r="3" stroke="currentColor" stroke-width="2"/>
            </svg>
            Adresse
          </h3>
          
          <div class="form-row">
            <div class="form-group">
              <label class="form-label" for="adress_line">Straße</label>
              <input type="text" name="adress_line" id="adress_line" class="form-control" value="{{ teacher.adress_line }}">
            </div>
            
            <div class="form-group">
              <label class="form-label" for="house_number">Hausnummer</label>
              <input type="text" name="house_number" id="house_number" class="form-control" value="{{ teacher.house_number }}">
            </div>
          </div>
          
          <div class="form-row">
            <div class="form-group">
              <label class="form-label" for="postal_code">Postleitzahl</label>
              <input type="text" name="postal_code" id="postal_code" class="form-control" value="{{ teacher.postal_code }}">
            </div>
            
            <div class="form-group">
              <label class="form-label" for="city">Stadt</label>
              <input type="text" name="city" id="city" class="form-control" value="{{ teacher.city }}">
            </div>
          </div>
          
          <div class="form-row-single">
            <div class="form-group">
              <label class="form-label" for="country">Land</label>
              <select name="country" id="country" class="form-select">
                <option value="">Kein Land ausgewählt</option>
                {% for country in countries %}
                <option value="{{ country.id }}" {% if teacher.country and teacher.country.id == country.id %}selected{% endif %}>
                  {{ country.country }}
                </option>
                {% endfor %}
              </select>
            </div>
          </div>
        </div>

        
        <!-- Biografie -->
        <div class="form-section">
          <h3 class="section-title">
            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" style="margin-right: 0.5rem;">
              <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z" stroke="currentColor" stroke-width="2"/>
              <polyline points="14,2 14,8 20,8" stroke="currentColor" stroke-width="2"/>
              <line x1="16" y1="13" x2="8" y2="13" stroke="currentColor" stroke-width="2"/>
              <line x1="16" y1="17" x2="8" y2="17" stroke="currentColor" stroke-width="2"/>
              <polyline points="10,9 9,9 8,9" stroke="currentColor" stroke-width="2"/>
            </svg>
            Biografie und Medien
          </h3>
          
          <div class="form-row-single">
            <div class="form-group">
              <label class="form-label" for="bio">Lebenslauf und beruflicher Werdegang</label>
              <textarea name="bio" id="bio" class="form-textarea" placeholder="Beschreiben Sie den beruflichen Werdegang und die Qualifikationen des Lehrers...">{{ teacher.bio }}</textarea>
              <div class="form-hint">Dieser Text wird auf der öffentlichen Lehrer-Profilseite angezeigt.</div>
            </div>
          </div>
          
          <div class="form-row">
            <div class="form-group">
              <label class="form-label" for="youtube_id_one">YouTube Video ID 1</label>
              <input type="text" name="youtube_id_one" id="youtube_id_one" class="form-control" value="{{ teacher.youtube_id_one }}" placeholder="dQw4w9WgXcQ">
              <div class="form-hint">Nur die Video-ID, nicht die komplette URL</div>
            </div>
            
            <div class="form-group">
              <label class="form-label" for="youtube_id_two">YouTube Video ID 2</label>
              <input type="text" name="youtube_id_two" id="youtube_id_two" class="form-control" value="{{ teacher.youtube_id_two }}" placeholder="dQw4w9WgXcQ">
              <div class="form-hint">Nur die Video-ID, nicht die komplette URL</div>
            </div>
          </div>
        </div>
      </form>
      
      <!-- Aktionen -->
      <div class="form-actions">
        <div class="btn-group">
          <button type="submit" form="teacher-form" class="btn btn-primary" id="save-btn">
            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
              <path d="M20 6L9 17L4 12" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
            </svg>
            Speichern
          </button>
          <a href="{% url 'controlling:teacher_detail' teacher.id %}" class="btn btn-secondary">
            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
              <path d="M18 6L6 18" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
              <path d="M6 6L18 18" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
            </svg>
            Abbrechen
          </a>
        </div>
        
        <button type="button" class="btn btn-danger" onclick="confirmDelete()">
          <svg width="16" height="16" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
            <polyline points="3,6 5,6 21,6" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
            <path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
          </svg>
          Lehrer löschen
        </button>
      </div>
    </div>
{% endblock %}
{% block footer %}
<script>
// Coordinator active/inactive toggle
const coordinatorActiveCheckbox = document.getElementById('coordinator_active');
const coordinatorSubjects = document.getElementById('coordinator-subjects');
const coordinatorCheckboxes = document.querySelectorAll('.coordinator-subject');
const statusIndicator = document.querySelector('.status-indicator');

if (coordinatorActiveCheckbox && coordinatorSubjects) {
  coordinatorActiveCheckbox.addEventListener('change', function() {
    if (this.checked) {
      coordinatorSubjects.classList.remove('inactive');
      coordinatorSubjects.style.opacity = '1';
      coordinatorSubjects.style.pointerEvents = 'auto';
      
      // Update status indicator
      statusIndicator.classList.add('active');
      statusIndicator.innerHTML = \`
        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
          <circle cx="12" cy="12" r="10" stroke="currentColor" stroke-width="2"/>
          <polyline points="9,12 12,15 16,10" stroke="currentColor" stroke-width="2"/>
        </svg>
        Fachbereichsleitung aktiv\`;
    } else {
      coordinatorSubjects.classList.add('inactive');
      coordinatorSubjects.style.opacity = '0.5';
      coordinatorSubjects.style.pointerEvents = 'none';
      
      // Update status indicator
      statusIndicator.classList.remove('active');
      statusIndicator.innerHTML = \`
        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
          <circle cx="12" cy="12" r="10" stroke="currentColor" stroke-width="2"/>
          <line x1="15" y1="9" x2="9" y2="15" stroke="currentColor" stroke-width="2"/>
          <line x1="9" y1="9" x2="15" y2="15" stroke="currentColor" stroke-width="2"/>
        </svg>
        Fachbereichsleitung inaktiv\`;
      
      // Uncheck all coordinator subjects when inactive
      coordinatorCheckboxes.forEach(checkbox => {
        checkbox.checked = false;
      });
    }
  });
}

// Delete confirmation
function confirmDelete() {
  const teacherName = '{{ teacher.first_name }} {{ teacher.last_name }}';
  
  if (confirm(\`Sind Sie sicher, dass Sie den Lehrer "\${teacherName}" dauerhaft löschen möchten?

Diese Aktion kann nicht rückgängig gemacht werden.\`)) {
    const form = document.createElement('form');
    form.method = 'POST';
    form.action = '{% url "controlling:teacher_delete" teacher.id %}';
    
    const csrfToken = document.createElement('input');
    csrfToken.type = 'hidden';
    csrfToken.name = 'csrfmiddlewaretoken';
    csrfToken.value = '{{ csrf_token }}';
    
    form.appendChild(csrfToken);
    document.body.appendChild(form);
    form.submit();
  }
}

// Form validation
document.getElementById('teacher-form').addEventListener('submit', function(e) {
  const firstName = document.getElementById('first_name').value.trim();
  const lastName = document.getElementById('last_name').value.trim();
  
  if (!firstName || !lastName) {
    e.preventDefault();
    alert('Bitte füllen Sie mindestens Vor- und Nachname aus.');
    return false;
  }
  
  // Show loading state on save button
  const saveBtn = document.getElementById('save-btn');
  const originalText = saveBtn.innerHTML;
  saveBtn.innerHTML = \`
    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
      <circle cx="12" cy="12" r="3" stroke="currentColor" stroke-width="2"/>
    </svg>
    Speichern...\`;
  saveBtn.disabled = true;
  
  // Reset button state after delay in case form submission fails
  setTimeout(() => {
    saveBtn.innerHTML = originalText;
    saveBtn.disabled = false;
  }, 5000);
});
</script>
{% endblock %}