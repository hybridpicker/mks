{% extends "templates/base.html" %}

{% load static %}
{% load thumbnail %}

{% block extra_head %}
<meta name="title" content="Galerie der Musikschule St. Pölten">
<meta name="description" content="Bilder und Impressionen der Musikschule St. Pölten in der Voithvilla am Südpark sowie unserer Schülerinnen, Schüler, Lehrer und Lehrerinnen.">

<!-- Social Media Meta --->
<meta property="og:title" content="Galerie der Musikschule St. Pölten">
<meta property="og:description" content="Bilder und Impressionen der Musikschule St. Pölten in der Voithvilla am Südpark sowie unserer Schülerinnen, Schüler, Lehrer und Lehrerinnen.">
<meta property="og:image" content="static/thumbnail/facebook/home.jpg">
<meta property="og:url" content="https://musikschule-stp.at/gallery">

<meta name="twitter:title" content="Galerie der Musikschule St. Pölten"">
<meta name="twitter:description" content="Bilder und Impressionen der Musikschule St. Pölten in der Voithvilla am Südpark sowie unserer Schülerinnen, Schüler, Lehrer und Lehrerinnen.">
<meta name="twitter:image" content="static/thumbnail/twitter/home.jpg">
<meta name="twitter:card" content="summary_large_image">

<script type="text/javascript">
var photo_data = {{ gallery_json_data|safe }}
</script>
<!-- Modern Gallery styles -->
<link rel="stylesheet" href="{% static 'gallery/css/modern/gallery.3.0.0.css' %}">
{% endblock %}

{% block navbar %}
{% endblock %}
{% block banner %}

{% endblock %}
{% block body %}

<div class="mbs">
  <div class="container gallery">
    <div class="gallery-header">
      <h1>Galerie</h1>
    </div>
    
    {% if photos %}
    <section class="gallery-show">
      {% for photo in photos %}
      {% if photo.image %}
          {% if photo.image.width > photo.image.height %}
          <picture class="landscape" onclick="showImg({{photo.id}})">
              {% thumbnail photo.image "500" crop="center" format="WEBP" as im %}
                <source srcset="{{ im.url }}" type="image/webp">
                {% endthumbnail %}
                {% thumbnail photo.image "500" crop="center" format="JPEG" as im %}
                <source srcset="{{ im.url }}" type="image/jpeg">
                <img src="{{ im.url }}" 
                width="{{ im.width }}" 
                height="{{ im.height }}"
                alt="{{ photo.title|default:'Gallery Image' }}"
                loading="lazy"
                class="lazy">
                {% empty %}
                <!-- Fallback für Bilder, die Probleme mit Thumbnails haben -->
                <img src="{{ photo.image.url }}" 
                    style="width: 100%; height: auto; max-width: 500px;" 
                    alt="{{ photo.title|default:'Gallery Image' }}"
                    loading="lazy"
                    class="lazy">
                {% endthumbnail %}
          </picture>
          {% elif photo.image.width == photo.image.height %}
          <picture class="square" onclick="showImg({{photo.id}})">
              {% thumbnail photo.image "500" crop="center" format="WEBP" as im %}
              <source srcset="{{ im.url }}" type="image/webp">
                {% endthumbnail %}
                {% thumbnail photo.image "500" crop="center" format="JPEG" as im %}
                <source srcset="{{ im.url }}" type="image/jpeg">
                <img src="{{ im.url }}" 
                width="{{ im.width }}" 
                height="{{ im.height }}"
                alt="{{ photo.title|default:'Gallery Image' }}"
                loading="lazy"
                class="lazy">
                {% empty %}
                <!-- Fallback für Bilder, die Probleme mit Thumbnails haben -->
                <img src="{{ photo.image.url }}" 
                    style="width: 100%; height: auto; max-width: 500px;" 
                    alt="{{ photo.title|default:'Gallery Image' }}"
                    loading="lazy"
                    class="lazy">
                {% endthumbnail %}
          </picture>
          {% else %}
            <picture class="portrait" onclick="showImg({{photo.id}})">
              {% thumbnail photo.image "400" crop="center" format="WEBP" as im %}
              <source srcset="{{ im.url }}" type="image/webp">
                {% endthumbnail %}
                {% thumbnail photo.image "400" crop="center" format="JPEG" as im %}
                <source srcset="{{ im.url }}" type="image/jpeg">
                <img src="{{ im.url }}" 
                width="{{ im.width }}" 
                height="{{ im.height }}"
                alt="{{ photo.title|default:'Gallery Image' }}"
                loading="lazy"
                class="lazy">
                {% empty %}
                <!-- Fallback für Bilder, die Probleme mit Thumbnails haben -->
                <img src="{{ photo.image.url }}" 
                    style="width: 100%; height: auto; max-width: 400px;" 
                    alt="{{ photo.title|default:'Gallery Image' }}"
                    loading="lazy"
                    class="lazy">
                {% endthumbnail %}
            </picture>
          {% endif %}
      {% endif %}
      {% empty %}
      <div class="empty-gallery-message">
        <p>Keine Bilder vorhanden.</p>
        {% if user.is_authenticated %}
        <p><a href="{% url 'gallery_admin' %}">Zur Galerie-Verwaltung</a></p>
        {% endif %}
      </div>
      {% endfor %}
    </section>
    {% else %}
    <div class="empty-gallery-message">
      <p>Keine Bilder vorhanden.</p>
      {% if user.is_authenticated %}
      <p><a href="{% url 'gallery_admin' %}">Zur Galerie-Verwaltung</a></p>
      {% endif %}
    </div>
    {% endif %}
    <section onclick="blockImg()" id="overlay-image-section" class="overlay image">
      <img id="overlay-show-img" src="" alt="">
      <a href="javascript:void(0)" id="closebtn-gallery" class="closebtn" onclick="blockImg()">
        {% include "templates/svg/nav_bar_crossburger_gallery.html" %}
      </a>
      <p id="gallery-text-overlay"></p>
    </section>
  </div>
</div>


{% endblock %}
{% block footer %}
<!-- Modern Gallery JavaScript -->
<script src="{% static 'gallery/js/modern/gallery.js' %}"></script>
{% endblock %}
