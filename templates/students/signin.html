{% extends "templates/base.html" %}
{% load i18n static %}

{% load static %}

{% block tab_id %}id="home_tab"{% endblock %}

{% block extra_head %}

<!-- Recaptcha -->

<script src='https://www.google.com/recaptcha/api.js?render={{public_key}}'></script>

<style media="screen">

</style>
{% endblock %}

{% block navbar %}
{% endblock %}
{% block banner %}
<img src="/static/media/banner/kontakt_banner.jpg" alt="">
<img id="mbimg" src="/static/media/banner/mobile/kontakt_banner.jpg" alt="">
{% endblock %}
{% block body %}
<div class="mbs">
  <div class="container">
    <h1 id="signin_heading">Voranmeldung</h1>
    <form id="signin_form_post" method="post">
      {% csrf_token %}
      <div class="row">
        <h2>Schüler_in</h2>
        <div class="col-4">
          <p>Vorname*</p>
        </div>
        <div class="col-8">
          {{ form.first_name }}
          {{ form.first_name.errors }}
        </div>
        <div class="col-4">
          <p>Familienname*</p>
        </div>
        <div class="col-8">
          {{ form.last_name }}
          {{ form.last_name.errors }}
        </div>
        <div class="col-4">
          <p>Instrument*</p>
        </div>
        <div class="sfbsfcon">
          <div class="col-8">
            {{ form.subject }}
          </div>
        </div>
        {{ form.subject.errors }}
        <h2>Erziehungsberechtigte</h2>
        <div class="col-4">
          <p>Vorname*</p>
        </div>
        <div class="col-8">
          {{ form.parent_first_name }}
          {{ form.parent_first_name.errors }}
        </div>
        <div class="col-4">
          <p>Familienname*</p>
        </div>
        <div class="col-8">
          {{ form.parent_last_name }}
          {{ form.parent_last_name.errors }}
        </div>
        <div class="col-4">
          <p>Email*</p>
        </div>
        <div class="col-8">
          {{ form.from_email }}
          {{ form.from_email.errors }}
        </div>
        <div class="col-4">
          <p>Straße*</p>
        </div>
        <div class="col-8">
          {{ form.adress_line }}
          {{ form.adress_line.errors }}
        </div>
        <div class="col-4">
          <p>Hausnummer*</p>
        </div>
        <div class="col-8">
          {{ form.house_number }}
          {{ form.house_number.errors }}
        </div>
        <div class="col-4">
          <p>Postleitzahl*</p>
        </div>
        <div class="col-4">
          {{ form.postal_code }}
          {{ form.postal_code.errors }}
        </div>
        <div class="col-4">
          <p>Stadt*</p>
        </div>
        <div class="col-4">
          {{ form.city }}
          {{ form.city.errors }}
        </div>
        <div class="col-8">
          <input type="hidden" id="g-recaptcha-response" name="g-recaptcha-response" value="">
        </div>
      </div>
      <div class="form-actions">
        <button type="submit">Anmelden</button>
      </div>
    </form>
    <p id="dsgvo-text">* Informationspflicht gem. Art. 13 DSGVO: Mit der Anmeldung stimmen die Teilnehmenden selbst bzw. bei Minderjährigkeit ihre gesetzlichen VertreterInnen zu, dass die Musik- und Kunstschule Maria-Theresia-Straße 23, 3100 St. Pölten, personenbezogene Daten über das Anmeldeformular zu folgenden Zwecken erhebt und zu folgenden Zwecken verarbeitet: Organisation und Administration des Musikunterrichts, Informationsaustausch, statistische Erhebungen, Teilnahmeverwaltung, sicherheitstechnische und feuerpolizeiliche sowie allgemeine notfallsbezogene Datenweitergabe. Die Speicherdauer der Daten beträgt maximal 5 Jahre ab erstmaliger Verarbeitung der Daten und verlängert sich bei jeder Inanspruchnahme der Services und Dienstleistungen um diesen Zeitraum. Sie haben das Recht auf Auskunft, Berichtigung, Löschung und Einschränkung der Verarbeitung der personenbezogenen Daten. Bitte wenden Sie sich diesbezüglich an die Direktion der Musik- und Kunstschule St. Pölten Mag. Alfred Kellner, PhD Maria-Theresia-Straße 23, 3100 St. Pölten, musikschule@st.poelten.gv.at. Weiters haben Sie das Recht auf Beschwerde bei der Aufsichtsbehörde (Österreichische Datenschutzbehörde, Wickenburggasse 8, 1080 Wien, dsb@dsb.gv.at). Nähere Informationen finden Sie in unserem <a target="_blank" href="{% url 'impressum' %}">Impressum</a>.</p>
  </div>


  {% endblock %}

  {% block footer %}
  <script>
    grecaptcha.ready(function() {
      grecaptcha.execute('{{public_key}}', {action: 'submit'})
      .then(function(token) {
        document.getElementById('g-recaptcha-response').value=token
      });
    });
  </script>
  <script type="text/javascript">
    var x, i, j, selElmnt, a, b, c;
    /* Look for any elements with the class "sfbsf": */
    x = document.getElementsByClassName("sfbsfcon");
    for (i = 0; i < x.length; i++) {
      selElmnt = x[i].getElementsByTagName("select")[0];
      /* For each element, create a new DIV that will act as the selected item: */
      a = document.createElement("DIV");
      a.setAttribute("class", "sese");
      a.innerHTML = selElmnt.options[selElmnt.selectedIndex].innerHTML;
      x[i].appendChild(a);
      /* For each element, create a new DIV that will contain the option list: */
      b = document.createElement("DIV");
      b.setAttribute("class", "slitcon sehi");
      for (j = 1; j < selElmnt.length; j++) {
        /* For each option in the original select element,
        create a new DIV that will act as an option item: */
        c = document.createElement("DIV");
        c.innerHTML = selElmnt.options[j].innerHTML;
        c.addEventListener("click", function(e) {
          /* When an item is clicked, update the original select box,
          and the selected item: */
          var y, i, k, s, h;
          s = this.parentNode.parentNode.getElementsByTagName("select")[0];
          h = this.parentNode.previousSibling;
          for (i = 0; i < s.length; i++) {
            if (s.options[i].innerHTML == this.innerHTML) {
              s.selectedIndex = i;
              h.innerHTML = this.innerHTML;
              y = this.parentNode.getElementsByClassName("swasd");
              for (k = 0; k < y.length; k++) {
                y[k].removeAttribute("class");
              }
              this.setAttribute("class", "swasd",);
              break;
            }
          }
          h.click();
          h.classList.add("active")
          console.log(h)
        });
        b.appendChild(c);
      }
      x[i].appendChild(b);
      a.addEventListener("click", function(e) {
        /* When the select box is clicked, close any other select boxes,
        and open/close the current select box: */
        e.stopPropagation();
        closeAllSelect(this);
        this.nextSibling.classList.toggle("sehi");
        this.classList.toggle("slar-active");
      });
    }

    function closeAllSelect(elmnt) {
      /*  Close all select boxes in the document,
      except the current select box: */
      var x, y, i, arrNo = [];
      x = document.getElementsByClassName("slitcon");
      y = document.getElementsByClassName("sese");
      for (i = 0; i < y.length; i++) {
        if (elmnt == y[i]) {
          arrNo.push(i)
        } else {
          y[i].classList.remove("slar-active");
        }
      }
      for (i = 0; i < x.length; i++) {
        if (arrNo.indexOf(i)) {
          x[i].classList.add("sehi");
        }
      }
    }

    /* If the user clicks anywhere outside the select box,
    then close all select boxes: */
    document.addEventListener("click", closeAllSelect);
  </script>
  {% endblock %}
