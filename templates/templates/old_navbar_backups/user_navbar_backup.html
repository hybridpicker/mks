{% load static %}

<!-- Admin Dashboard Navigation -->
<header id="UserNav">
  <div class="nvb">
    <!-- Logo Area -->
    <div class="bnbs">
      <div class="bls">
        <a href="{% url 'home_view' %}" aria-label="Zur Startseite">
          {% include "templates/svg/nav_bar_icon.html" %}
        </a>
      </div>
    </div>
    
    <!-- Navigation Area -->
    <div class="bns">
      <div class="drops">
        {% if request.user.is_staff %}
        <!-- Schüler:innen Navigation -->
        <div class="dropdown">
          <button class="dropbtn">
            <svg class="nav-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
              <path d="M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"></path>
              <circle cx="9" cy="7" r="4"></circle>
              <path d="M23 21v-2a4 4 0 0 0-3-3.87"></path>
              <path d="M16 3.13a4 4 0 0 1 0 7.75"></path>
            </svg>
            <a href="{% url 'controlling:get_controlling_students' %}">Schüler:innen</a>
          </button>
          <div class="dropdown-content">
            <a href="{% url 'controlling:get_controlling_students' %}">
              <svg class="nav-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                <path d="M4 19.5A2.5 2.5 0 0 1 6.5 17H20"></path>
                <path d="M6.5 2H20v20H6.5A2.5 2.5 0 0 1 4 19.5v-15A2.5 2.5 0 0 1 6.5 2z"></path>
              </svg>
              Anmeldungen
            </a>
          </div>
        </div>
        
        <!-- Wartungsbereich (Maintenance) Dropdown -->
        <div class="dropdown-b">
          <button class="dropbtn-b">
            <svg class="nav-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
              <path d="M14.7 6.3a1 1 0 0 0 0 1.4l1.6 1.6a1 1 0 0 0 1.4 0l3.77-3.77a6 6 0 0 1-7.94 7.94l-6.91 6.91a2.12 2.12 0 0 1-3-3l6.91-6.91a6 6 0 0 1 7.94-7.94l-3.76 3.76z"></path>
            </svg>
            <a href="{% url 'event_managing_view' %}">Wartung</a>
          </button>
          <div class="dropdown-content-b">
            <a href="{% url 'event_managing_view' %}">
              <svg class="nav-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                <rect x="3" y="4" width="18" height="18" rx="2" ry="2"></rect>
                <line x1="16" y1="2" x2="16" y2="6"></line>
                <line x1="8" y1="2" x2="8" y2="6"></line>
                <line x1="3" y1="10" x2="21" y2="10"></line>
              </svg>
              Veranstaltungen
            </a>
            <a href="{% url 'invitation:invitation_list' %}">
              <svg class="nav-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                <polyline points="9 11 12 14 22 4"></polyline>
                <path d="M21 12v7a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11"></path>
              </svg>
              Zusagen
            </a>
            <a href="{% url 'show_blogs_editing' %}">
              <svg class="nav-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                <path d="M12 20h9"></path>
                <path d="M16.5 3.5a2.121 2.121 0 0 1 3 3L7 19l-4 1 1-4L16.5 3.5z"></path>
              </svg>
              Blog
            </a>
            <a href="{% url 'controlling:get_index_text' %}">
              <svg class="nav-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                <path d="M3 9l9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"></path>
                <polyline points="9 22 9 12 15 12 15 22"></polyline>
              </svg>
              Startseite
            </a>
            <a href="{% url 'get_all_faqs' %}">
              <svg class="nav-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                <circle cx="12" cy="12" r="10"></circle>
                <path d="M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3"></path>
                <line x1="12" y1="17" x2="12.01" y2="17"></line>
              </svg>
              FAQ
            </a>
            <a href="/tanz-und-bewegung/wartung/">
              <svg class="nav-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                <path d="M9 18V5l12-2v13"></path>
                <circle cx="6" cy="18" r="3"></circle>
                <circle cx="18" cy="16" r="3"></circle>
              </svg>
              Tanz & Bewegung
            </a>
            <a href="{% url 'gallery_admin' %}">
              <svg class="nav-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                <rect x="3" y="3" width="18" height="18" rx="2" ry="2"></rect>
                <circle cx="8.5" cy="8.5" r="1.5"></circle>
                <polyline points="21 15 16 10 5 21"></polyline>
              </svg>
              Galerie
            </a>
          </div>
        </div>
        
        <!-- Quick-Actions wurden entfernt -->
        {% endif %}
        
        {% if request.user.coordinator %}
        <!-- Koordinator Navigation -->
        <div class="dropdown">
          <button class="dropbtn">
            <svg class="nav-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
              <path d="M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"></path>
              <circle cx="9" cy="7" r="4"></circle>
            </svg>
            <a href="/team/controlling/coordinator/students?user_id={{ request.user.id }}">Schüler:innen</a>
          </button>
        </div>
        {% endif %}
        
        <!-- User Dropdown mit Logout -->
        <div class="dropdown-e">
          <form method="post" action="{% url 'logout' %}" style="margin: 0; padding: 0;">
            {% csrf_token %}
            <button type="submit" class="logoutLink" aria-label="Ausloggen" title="Ausloggen">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                <path d="M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4"></path>
                <polyline points="16 17 21 12 16 7"></polyline>
                <line x1="21" y1="12" x2="9" y2="12"></line>
              </svg>
              <span class="tooltiptext">Ausloggen</span>
            </button>
          </form>
        </div>
      </div>
    </div>
  </div>

  <!-- Mobile Navigation -->
  <div id="mks-nav-mobile" class="menu">
    <div>
      <span id="menuIcon" onclick="openNav()" aria-label="Menü öffnen">
        {% include "templates/svg/nav_bar_hamburger_mobile.html" %}
      </span>
    </div>
    <div class="mobile-admin-indicator">
      {% if request.user.is_staff %}
      <span class="admin-badge">Admin</span>
      {% endif %}
    </div>
    <div id="mobileLogo">
      <a id="small-mobile-logo" href="{% url 'home_view' %}" aria-label="Zur Startseite">
        {% include "templates/svg/nav_bar_mobile_logo.html" %}
      </a>
      <a id="medium-mobile-logo" href="{% url 'home_view' %}" aria-label="Zur Startseite">
        {% include "templates/svg/nav_bar_icon.html" %}
      </a>
    </div>
  </div>
  
  <!-- Mobile Menu Overlay -->
  <div id="mks-nav-mobile-menu" class="overlay">
    <div class="overlay-content">
      <a id="closeMobileMenu" href="javascript:void(0)" class="closebtn" onclick="closeNav()" aria-label="Menü schließen">
        {% include "templates/svg/nav_bar_crossburger.html" %}
      </a>
      
      {% if request.user.is_staff %}
      <div class="mobile-user-info">
        <span class="mobile-user-name">{{ request.user.get_full_name }}</span>
        <span class="mobile-user-role">Administrator</span>
      </div>
      
      <a class="mainHeadingMobile" href="{% url 'event_managing_view' %}">
        <svg class="nav-icon mobile" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
          <rect x="3" y="4" width="18" height="18" rx="2" ry="2"></rect>
          <line x1="16" y1="2" x2="16" y2="6"></line>
          <line x1="8" y1="2" x2="8" y2="6"></line>
          <line x1="3" y1="10" x2="21" y2="10"></line>
        </svg>
        Veranstaltungen
      </a>
      <a class="mainHeadingMobile" href="{% url 'invitation:invitation_list' %}">
        <svg class="nav-icon mobile" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
          <polyline points="9 11 12 14 22 4"></polyline>
          <path d="M21 12v7a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11"></path>
        </svg>
        Zusagen
      </a>
      <a class="mainHeadingMobile" href="{% url 'controlling:get_controlling_students' %}">
        <svg class="nav-icon mobile" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
          <path d="M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"></path>
          <circle cx="9" cy="7" r="4"></circle>
          <path d="M23 21v-2a4 4 0 0 0-3-3.87"></path>
          <path d="M16 3.13a4 4 0 0 1 0 7.75"></path>
        </svg>
        Schüler:innen
      </a>
      <a class="categoryHeadingMobileNoCursor" href="{% url 'controlling:get_controlling_students' %}">Anmeldungen</a>
      <a class="mainHeadingMobile" href="{% url 'controlling:get_index_text' %}">
        <svg class="nav-icon mobile" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
          <path d="M3 9l9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"></path>
          <polyline points="9 22 9 12 15 12 15 22"></polyline>
        </svg>
        Startseite
      </a>
      <a class="mainHeadingMobile" href="{% url 'get_all_faqs' %}">
        <svg class="nav-icon mobile" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
          <circle cx="12" cy="12" r="10"></circle>
          <path d="M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3"></path>
          <line x1="12" y1="17" x2="12.01" y2="17"></line>
        </svg>
        FAQ
      </a>
      <a class="mainHeadingMobile" href="/tanz-und-bewegung/wartung/">
        <svg class="nav-icon mobile" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
          <circle cx="12" cy="12" r="10"></circle>
          <polyline points="8 14 12 10 16 14"></polyline>
        </svg>
        Tanz & Bewegung
      </a>
      <a class="mainHeadingMobile" href="{% url 'gallery_admin' %}">
        <svg class="nav-icon mobile" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
          <rect x="3" y="3" width="18" height="18" rx="2" ry="2"></rect>
          <circle cx="8.5" cy="8.5" r="1.5"></circle>
          <polyline points="21 15 16 10 5 21"></polyline>
        </svg>
        Galerie
      </a>
      {% endif %}
      
      {% if request.user.coordinator %}
      <div class="mobile-user-info">
        <span class="mobile-user-name">{{ request.user.get_full_name }}</span>
        <span class="mobile-user-role">Koordinator</span>
      </div>
      <a class="mainHeadingMobile" href="/team/controlling/coordinator/students?user_id={{ request.user.id }}">
        <svg class="nav-icon mobile" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
          <path d="M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"></path>
          <circle cx="9" cy="7" r="4"></circle>
        </svg>
        Schüler:innen
      </a>
      {% endif %}
      
      <div class="mobile-nav-footer">
        <a class="mainHeadingMobile logout-mobile" href="{% url 'logout' %}">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
            <path d="M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4"></path>
            <polyline points="16 17 21 12 16 7"></polyline>
            <line x1="21" y1="12" x2="9" y2="12"></line>
          </svg>
          Ausloggen
        </a>
      </div>
    </div>
  </div>
</header>

<!-- JavaScript für erweiterte Funktionalität -->
<script>
document.addEventListener('DOMContentLoaded', function() {
  // System Status Popup
  const systemStatusBtn = document.getElementById('system-status');
  if (systemStatusBtn) {
    systemStatusBtn.addEventListener('click', function() {
      // Hier könnte ein AJAX-Request erfolgen, um Systemstatus zu laden
      alert('System läuft einwandfrei. Letztes Backup: Heute 05:30 Uhr');
    });
  }
  
  // Create New Content Dropdown
  const createNewBtn = document.getElementById('create-new-content');
  if (createNewBtn) {
    createNewBtn.addEventListener('click', function() {
      const urls = {
        'Blog': '{% url "show_blogs_editing" %}',
        'Event': '{% url "event_managing_view" %}',
        'FAQ': '{% url "get_all_faqs" %}'
      };
      
      // Einfaches Dropdown für schnellen Zugriff
      const selection = prompt('Neuen Inhalt erstellen:\n1: Blog\n2: Event\n3: FAQ');
      if (selection === '1') window.location.href = urls['Blog'];
      else if (selection === '2') window.location.href = urls['Event'];
      else if (selection === '3') window.location.href = urls['FAQ'];
    });
  }
  
  // Aktiven Menüpunkt hervorheben
  const currentPath = window.location.pathname;
  const navLinks = document.querySelectorAll('.dropbtn a, .dropbtn-b a, .dropdown-content a, .dropdown-content-b a');
  
  navLinks.forEach(link => {
    if (link.getAttribute('href') === currentPath) {
      link.classList.add('active-link');
    }
  });
});

// Mobile Navigation Funktionen
function openNav() {
  document.getElementById("mks-nav-mobile-menu").style.height = "100%";
}

function closeNav() {
  document.getElementById("mks-nav-mobile-menu").style.height = "0%";
}
</script>