{% extends "templates/base.html" %}
{% load static %}

{% block tab_id %}id="team_dashboard_tab"{% endblock %}

{% block extra_head %}
<meta name="robots" content="noindex">
<link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
<style>
.dashboard-container { padding: 0; margin: 0; background: #fdfdfd; min-height: 100vh; }
.dashboard-hero { background: #f8f9fa; padding: 3rem 2rem; text-align: center; }
.dashboard-title { font-family: "jaf-bernina-sans-condensed", sans-serif; font-size: 3.2rem; font-weight: 800; color: #D11317; margin: 0 0 1rem 0; letter-spacing: -0.03em; }
.dashboard-subtitle { font-family: "jaf-bernina-sans-condensed", sans-serif; font-size: 1.3rem; color: #666; font-weight: 500; max-width: 600px; margin: 0 auto 2rem; line-height: 1.6; }
.user-info-header { background: white; border: 1px solid #e0e0e0; border-radius: 16px; padding: 2rem 2.5rem; margin: -2rem 2rem 3rem; display: flex; justify-content: space-between; align-items: center; box-shadow: 0 4px 12px rgba(0,0,0,0.05); position: relative; z-index: 10; transition: all 0.3s ease; }
.user-info-header:hover { box-shadow: 0 8px 24px rgba(0,0,0,0.1); transform: translateY(-2px); }
.user-section { display: flex; align-items: center; gap: 1.5rem; }
.user-avatar { width: 60px; height: 60px; border-radius: 50%; background: #D11317; display: flex; align-items: center; justify-content: center; color: white; font-weight: 800; font-family: "jaf-bernina-sans-condensed", sans-serif; font-size: 1.5rem; box-shadow: 0 4px 12px rgba(209, 19, 23, 0.2); }
.user-details { min-width: 200px; }
.welcome-text { font-family: "jaf-bernina-sans-condensed", sans-serif; font-size: 1.3rem; color: #333; font-weight: 700; margin: 0 0 0.3rem 0; letter-spacing: -0.01em; }
.user-role { font-family: "jaf-bernina-sans-condensed", sans-serif; font-size: 1rem; color: #666; margin: 0; font-weight: 500; text-transform: uppercase; letter-spacing: 0.5px; }
.logout-link { color: #D11317; text-decoration: none; font-family: "jaf-bernina-sans-condensed", sans-serif; font-size: 1.1rem; font-weight: 600; padding: 0.8rem 1.5rem; border-radius: 8px; transition: all 0.3s ease; border: 1px solid #D11317; }
.logout-link:hover { background: #D11317; color: white; text-decoration: none; transform: translateY(-1px); box-shadow: 0 4px 12px rgba(209, 19, 23, 0.2); }
.stats-section { margin: 0 2rem 3rem; background: white; border: 1px solid #e0e0e0; border-radius: 16px; padding: 3rem; box-shadow: 0 4px 12px rgba(0,0,0,0.05); }
.stats-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 2.5rem; text-align: center; }
.stat-item { padding: 2rem 1.5rem; transition: all 0.4s ease; border-radius: 12px; background: #fafafa; border: 1px solid #f0f0f0; }
.stat-item:hover { transform: translateY(-8px); box-shadow: 0 12px 32px rgba(209, 19, 23, 0.1); border-color: #D11317; }
.stat-number { font-size: 2.8rem; font-weight: 900; color: #D11317; font-family: "jaf-bernina-sans-condensed", sans-serif; text-decoration: none; display: block; margin-bottom: 0.8rem; letter-spacing: -0.02em; }
.stat-label { color: #555; font-weight: 600; font-size: 1.2rem; font-family: "jaf-bernina-sans-condensed", sans-serif; text-transform: uppercase; letter-spacing: 1px; }
.dashboard-content { padding: 0 2rem 4rem; }
.dashboard-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(380px, 1fr)); gap: 2.5rem; max-width: 1400px; margin: 0 auto; }
.dashboard-card { background: white; border: 1px solid #e0e0e0; border-radius: 20px; padding: 3rem; box-shadow: 0 4px 12px rgba(0,0,0,0.05); transition: all 0.5s ease; display: flex; flex-direction: column; }
.dashboard-card:hover { box-shadow: 0 16px 40px rgba(209, 19, 23, 0.1); transform: translateY(-12px); border-color: #D11317; }
.card-icon { width: 70px; height: 70px; background: #D11317; border-radius: 16px; display: flex; align-items: center; justify-content: center; font-size: 1.8rem; color: white; margin-bottom: 2rem; box-shadow: 0 4px 12px rgba(209, 19, 23, 0.2); transition: all 0.4s ease; }
.dashboard-card:hover .card-icon { transform: scale(1.1); box-shadow: 0 8px 20px rgba(209, 19, 23, 0.3); }
.card-title { font-size: 1.4rem; font-weight: 700; color: #333; margin-bottom: 1rem; font-family: "jaf-bernina-sans-condensed", sans-serif; letter-spacing: -0.01em; }
.card-description { color: #666; line-height: 1.7; margin-bottom: auto; font-family: "jaf-bernina-sans-condensed", sans-serif; font-size: 1.1rem; text-align: left; padding: 0 0 2rem 0; flex-grow: 1; }
.card-button { font-family: "jaf-bernina-sans-condensed", sans-serif; font-size: 1.2rem; width: 100%; height: 48px; background: #D11317; color: white; font-weight: 600; border: none; border-radius: 12px; cursor: pointer; transition: all 0.4s ease; text-decoration: none; display: flex; align-items: center; justify-content: center; text-transform: uppercase; letter-spacing: 0.5px; }
.card-button:hover { background: #b10e13; text-decoration: none; color: white; transform: translateY(-3px); box-shadow: 0 8px 20px rgba(209, 19, 23, 0.3); }
.login-prompt { text-align: center; background: white; border: 1px solid #e0e0e0; border-radius: 24px; padding: 5rem 4rem; box-shadow: 0 8px 24px rgba(0,0,0,0.1); margin: 4rem 2rem; max-width: 600px; margin-left: auto; margin-right: auto; }
.login-prompt h1 { font-family: "jaf-bernina-sans-condensed", sans-serif; font-size: 2.6rem; color: #D11317; font-weight: 800; margin-bottom: 1.5rem; letter-spacing: -0.02em; }
.login-prompt p { font-family: "jaf-bernina-sans-condensed", sans-serif; color: #666; margin-bottom: 3rem; font-size: 1.3rem; text-align: center; padding: 0; line-height: 1.6; }
.login-button { font-family: "jaf-bernina-sans-condensed", sans-serif; font-size: 1.4rem; padding: 1.5rem 3rem; background: #D11317; color: white; font-weight: 600; border: none; border-radius: 12px; cursor: pointer; transition: all 0.4s ease; text-decoration: none; display: inline-block; text-transform: uppercase; letter-spacing: 0.5px; }
.login-button:hover { background: #b10e13; text-decoration: none; color: white; transform: translateY(-4px); box-shadow: 0 12px 28px rgba(209, 19, 23, 0.3); }
@media (max-width: 768px) { .dashboard-hero { padding: 3rem 1.5rem 2rem; } .dashboard-title { font-size: 2.2rem; } .user-info-header { flex-direction: column; gap: 1.5rem; padding: 2rem; margin: -1.5rem 1rem 2rem; } .user-section { flex-direction: column; gap: 1rem; } .user-details { min-width: auto; text-align: center; } .stats-section { margin: 0 1rem 2rem; padding: 2rem; } .stats-grid { grid-template-columns: repeat(2, 1fr); gap: 1.5rem; } .dashboard-content { padding: 0 1rem 3rem; } .dashboard-grid { grid-template-columns: 1fr; gap: 2rem; } .dashboard-card { padding: 2.5rem; } .card-icon { width: 60px; height: 60px; } .login-prompt { padding: 4rem 3rem; margin: 3rem 1rem; } .stat-number { font-size: 2.4rem; } }
@media (max-width: 480px) { .dashboard-title { font-size: 1.8rem; } .stats-section { padding: 1.5rem; } .stats-grid { grid-template-columns: 1fr; gap: 1rem; } .dashboard-card { padding: 2rem; } .login-prompt { padding: 3rem 2rem; } .stat-number { font-size: 2rem; } }
.bs{height: 0!important;}
</style>
{% endblock %}

{% block body %}
<div class="mbs">
  <div class="dashboard-container">
    {% if user.is_authenticated %}
      <div class="dashboard-hero">
        <h1 class="dashboard-title">Administrator Dashboard</h1>
        <p class="dashboard-subtitle">Musikschule St. Pölten - Zentrale Verwaltung</p>
      </div>

      <div class="user-info-header">
        <div class="user-section">
          <div class="user-avatar">{{ user.first_name.0|default:user.username.0|upper }}{{ user.last_name.0|default:""|upper }}</div>
          <div class="user-details">
            <p class="welcome-text">Willkommen, {{ user.first_name|default:user.username }}!</p>
            <p class="user-role">System Administrator</p>
          </div>
        </div>
        <a href="/team/logout/" class="logout-link">Abmelden</a>
      </div>

      <!-- 2FA Warning Banner -->
      {% if not user.is_2fa_enabled %}
      <div style="background: #fff3cd; border: 1px solid #ffeaa7; border-radius: 12px; padding: 1.5rem 2rem; margin: 0 2rem 2rem; display: flex; align-items: center; gap: 1rem;">
        <div style="font-size: 1.5rem;">⚠️</div>
        <div style="flex: 1;">
          <strong style="color: #856404; font-family: 'jaf-bernina-sans-condensed', sans-serif; font-size: 1.1rem;">Sicherheitshinweis:</strong>
          <p style="color: #856404; margin: 0.5rem 0 0 0; font-family: 'jaf-bernina-sans-condensed', sans-serif;">
            Für zusätzliche Sicherheit sollten Sie die Zwei-Faktor-Authentifizierung aktivieren.
          </p>
        </div>
        <a href="/team/2fa/setup/" style="background: #ffc107; color: #212529; padding: 0.75rem 1.5rem; border-radius: 8px; text-decoration: none; font-weight: 600; font-family: 'jaf-bernina-sans-condensed', sans-serif; transition: all 0.3s ease;">
          Jetzt einrichten
        </a>
      </div>
      {% endif %}

      <div class="stats-section">
        <div class="stats-grid">
          <div class="stat-item"><span class="stat-number">{{ stats.teachers }}</span><div class="stat-label">Lehrkräfte</div></div>
          <div class="stat-item"><span class="stat-number">{{ stats.subjects }}</span><div class="stat-label">Instrumente</div></div>
          <div class="stat-item"><span class="stat-number">{{ stats.students }}</span><div class="stat-label">Voranmeldungen</div></div>
        </div>
      </div>

      <div class="dashboard-content">
        <div class="dashboard-grid">
          <div class="dashboard-card">
            <div class="card-icon"><svg width="32" height="32" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M12 12C14.7614 12 17 9.76142 17 7C17 4.23858 14.7614 2 12 2C9.23858 2 7 4.23858 7 7C7 9.76142 9.23858 12 12 12Z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/><path d="M20.59 22C20.59 18.13 16.74 15 12 15C7.26 15 3.41 18.13 3.41 22" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/></svg></div>
            <div class="card-title">Team verwalten</div>
            <div class="card-description">Verwalten Sie alle Lehrkräfte, bearbeiten Sie Profile und organisieren Sie Zuständigkeiten der Musikschule.</div>
            <a href="/team/team/" class="card-button">Team anzeigen</a>
          </div>
          <div class="dashboard-card">
            <div class="card-icon"><svg width="32" height="32" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><rect x="3" y="4" width="18" height="18" rx="2" ry="2" stroke="currentColor" stroke-width="2"/><line x1="16" y1="2" x2="16" y2="6" stroke="currentColor" stroke-width="2"/><line x1="8" y1="2" x2="8" y2="6" stroke="currentColor" stroke-width="2"/><line x1="3" y1="10" x2="21" y2="10" stroke="currentColor" stroke-width="2"/></svg></div>
            <div class="card-title">Veranstaltungen</div>
            <div class="card-description">Planen und verwalten Sie Konzerte, Aufführungen und andere wichtige Schulveranstaltungen.</div>
            <a href="/team/events" class="card-button">Events verwalten</a>
          </div>
          <div class="dashboard-card">
            <div class="card-icon"><svg width="32" height="32" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><line x1="18" y1="20" x2="18" y2="10" stroke="currentColor" stroke-width="2"/><line x1="12" y1="20" x2="12" y2="4" stroke="currentColor" stroke-width="2"/><line x1="6" y1="20" x2="6" y2="14" stroke="currentColor" stroke-width="2"/></svg></div>
            <div class="card-title">Controlling</div>
            <div class="card-description">Überwachen Sie Finanzen, Statistiken und wichtige Kennzahlen der Musikschule.</div>
            <a href="/controlling/" class="card-button">Controlling öffnen</a>
          </div>
          <div class="dashboard-card">
            <div class="card-icon"><svg width="32" height="32" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><rect x="3" y="3" width="18" height="18" rx="2" ry="2" stroke="currentColor" stroke-width="2"/><circle cx="8.5" cy="8.5" r="1.5" stroke="currentColor" stroke-width="2"/><polyline points="21,15 16,10 5,21" stroke="currentColor" stroke-width="2"/></svg></div>
            <div class="card-title">Galerie</div>
            <div class="card-description">Verwalten Sie Fotos von Konzerten, Veranstaltungen und dem Schulleben der Musikschule.</div>
            <a href="/galerie/admin/" class="card-button">Galerie verwalten</a>
          </div>
          <div class="dashboard-card">
            <div class="card-icon"><svg width="32" height="32" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><rect x="3" y="11" width="18" height="11" rx="2" ry="2" stroke="currentColor" stroke-width="2"/><circle cx="12" cy="16" r="1" stroke="currentColor" stroke-width="2"/><path d="M7 11V7a5 5 0 0 1 10 0v4" stroke="currentColor" stroke-width="2"/></svg></div>
            <div class="card-title">Sicherheit</div>
            <div class="card-description">Zwei-Faktor-Authentifizierung einrichten und Sicherheitseinstellungen verwalten.</div>
            <a href="/team/security/" class="card-button">Sicherheitseinstellungen</a>
          </div>
        
          
    {% if user.is_superuser %}<div class="dashboard-card">
            <div class="card-icon"><i class="fas fa-users-cog"></i></div>
            <div class="card-title">Benutzerverwaltung</div>
            <div class="card-description">
              Benutzer und Rollen verwalten, Berechtigungen zuweisen und System-Zugriffe kontrollieren.
            </div>
            <a href="/team/management/users/" class="card-button">Verwaltung öffnen</a>
          </div>
    {% endif %}</div>
      </div>
    {% else %}
      <div class="dashboard-hero">
        <h1 class="dashboard-title">Musikschule St. Pölten</h1>
        <p class="dashboard-subtitle">Administrator Dashboard</p>
      </div>
      <div class="login-prompt">
        <h1>Anmeldung erforderlich</h1>
        <p>Bitte melden Sie sich an, um auf das Administrator-Dashboard der Musikschule St. Pölten zuzugreifen.</p>
        <a href="/team/login/" class="login-button">Jetzt anmelden</a>
      </div>
    {% endif %}
  </div>
</div>
{% endblock %}
{% block footer %}{% endblock %}