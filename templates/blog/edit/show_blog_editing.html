{% load i18n static %}
{% load static %}

<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <title>Blog Verwaltung - Musikschule St. Pölten</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <meta name="robots" content="noindex, nofollow">
    
    {% include "templates/favicon.html" %}
    
    <!-- Admin Navigation CSS -->
    <link rel="stylesheet" href="{% static 'css/admin_nav.3.0.3.css' %}">
    
    <style>
        /* Reset and base styles */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        html, body {
            font-family: jaf-bernina-sans-condensed, sans-serif;
            background-color: #fdfdfd;
            color: #333;
            line-height: 1.6;
        }
        
        body {
            padding-top: 6rem; /* Space for fixed navbar */
            min-height: 100vh;
        }
        
        /* Container */
        .blog-management-container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 2rem;
        }
        
        /* Header */
        .blog-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 3rem;
            padding-bottom: 1.5rem;
            border-bottom: 2px solid #e5e7eb;
        }
        
        .blog-title {
            font-size: 2.5rem;
            font-weight: 600;
            color: #d11317;
            margin: 0;
            font-family: jaf-bernina-sans-condensed, sans-serif;
        }
        
        .btn-new-post {
            display: inline-flex;
            align-items: center;
            gap: 0.75rem;
            padding: 1rem 1.5rem;
            background-color: #d11317;
            color: white;
            border: none;
            border-radius: 8px;
            font-size: 1rem;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.3s ease;
            text-decoration: none;
            font-family: jaf-bernina-sans-condensed, sans-serif;
        }
        
        .btn-new-post:hover {
            background-color: #b01115;
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(209, 19, 23, 0.3);
            color: white;
            text-decoration: none;
        }
        
        .btn-new-post svg {
            width: 20px;
            height: 20px;
        }
        
        /* Grid */
        .blog-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(360px, 1fr));
            gap: 2rem;
        }
        
        /* Blog Cards */
        .blog-card {
            background: white;
            border-radius: 12px;
            overflow: hidden;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.05), 0 8px 16px rgba(0, 0, 0, 0.1);
            border: 1px solid #e5e7eb;
            transition: all 0.3s ease;
        }
        
        .blog-card:hover {
            transform: translateY(-8px);
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.15);
            border-color: #d11317;
        }
        
        .blog-image {
            width: 100%;
            height: 220px;
            object-fit: cover;
        }
        
        .blog-image-placeholder {
            width: 100%;
            height: 220px;
            background-color: #f8f9fa;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .blog-image-placeholder svg {
            width: 80px;
            height: 80px;
            color: #d1d5db;
        }
        
        .blog-content {
            padding: 1.5rem;
        }
        
        .blog-card-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: 1rem;
        }
        
        .blog-card-title {
            font-size: 1.375rem;
            font-weight: 600;
            color: #333;
            margin: 0;
            line-height: 1.3;
            flex: 1;
            margin-right: 1rem;
            font-family: jaf-bernina-sans-condensed, sans-serif;
        }
        
        .blog-status {
            padding: 0.375rem 0.75rem;
            border-radius: 50px;
            font-size: 0.8rem;
            font-weight: 500;
            white-space: nowrap;
            font-family: jaf-bernina-sans-condensed, sans-serif;
        }
        
        .status-published {
            background-color: #dcfce7;
            color: #166534;
        }
        
        .status-draft {
            background-color: #fed7aa;
            color: #9a3412;
        }
        
        .blog-meta {
            display: flex;
            flex-wrap: wrap;
            gap: 1rem;
            margin-bottom: 1rem;
            font-size: 0.9rem;
            color: #6b7280;
        }
        
        .blog-meta-item {
            display: flex;
            align-items: center;
            gap: 0.375rem;
            font-family: jaf-bernina-sans-condensed, sans-serif;
        }
        
        .blog-meta-item svg {
            width: 16px;
            height: 16px;
        }
        
        .blog-category {
            background-color: #f3f4f6;
            padding: 0.375rem 0.75rem;
            border-radius: 6px;
            font-size: 0.8rem;
            font-weight: 500;
            color: #374151;
            font-family: jaf-bernina-sans-condensed, sans-serif;
        }
        
        .blog-excerpt {
            color: #6b7280;
            font-size: 0.95rem;
            line-height: 1.6;
            margin-bottom: 1.5rem;
            display: -webkit-box;
            -webkit-line-clamp: 3;
            -webkit-box-orient: vertical;
            overflow: hidden;
            font-family: jaf-bernina-sans-condensed, sans-serif;
        }
        
        .blog-actions {
            display: flex;
            gap: 0.75rem;
            padding-top: 1rem;
            border-top: 1px solid #e5e7eb;
        }
        
        .blog-btn {
            flex: 1;
            padding: 0.75rem 1rem;
            text-align: center;
            border-radius: 8px;
            font-size: 0.9rem;
            font-weight: 500;
            text-decoration: none;
            transition: all 0.3s ease;
            border: none;
            cursor: pointer;
            font-family: jaf-bernina-sans-condensed, sans-serif;
        }
        
        .btn-edit {
            background-color: #d11317;
            color: white;
        }
        
        .btn-edit:hover {
            background-color: #b01115;
            color: white;
            text-decoration: none;
            transform: translateY(-1px);
        }
        
        .btn-view {
            background-color: white;
            color: #374151;
            border: 1.5px solid #e5e7eb;
        }
        
        .btn-view:hover {
            background-color: #f9fafb;
            border-color: #d11317;
            color: #d11317;
            text-decoration: none;
            transform: translateY(-1px);
        }
        
        /* Empty State */
        .blog-empty {
            text-align: center;
            padding: 4rem 2rem;
            background: white;
            border-radius: 12px;
            border: 2px dashed #e5e7eb;
            margin-top: 2rem;
        }
        
        .blog-empty svg {
            width: 120px;
            height: 120px;
            margin-bottom: 2rem;
            color: #d1d5db;
        }
        
        .blog-empty h2 {
            font-size: 1.75rem;
            font-weight: 600;
            color: #374151;
            margin-bottom: 1rem;
            font-family: jaf-bernina-sans-condensed, sans-serif;
        }
        
        .blog-empty p {
            color: #6b7280;
            font-size: 1.1rem;
            margin-bottom: 2rem;
            max-width: 400px;
            margin-left: auto;
            margin-right: auto;
            font-family: jaf-bernina-sans-condensed, sans-serif;
        }
        
        /* Responsive */
        @media (max-width: 820px) {
            body {
                padding-top: 4rem;
            }
        }
        
        @media (max-width: 768px) {
            .blog-management-container {
                padding: 1rem;
            }
            
            .blog-header {
                flex-direction: column;
                gap: 1.5rem;
                align-items: flex-start;
            }
            
            .blog-title {
                font-size: 2rem;
            }
            
            .blog-grid {
                grid-template-columns: 1fr;
                gap: 1.5rem;
            }
            
            .blog-card-header {
                flex-direction: column;
                gap: 0.75rem;
                align-items: flex-start;
            }
            
            .blog-card-title {
                margin-right: 0;
            }
            
            .blog-actions {
                flex-direction: column;
            }
        }
        
        @media (max-width: 480px) {
            .blog-management-container {
                padding: 0.75rem;
            }
            
            .blog-content {
                padding: 1rem;
            }
            
            .blog-empty {
                padding: 2rem 1rem;
            }
        }
    </style>
</head>

<body>
    <!-- Enhanced User Navigation -->
    {% if user.is_authenticated %}
        {% include "templates/user_navbar.html" %}
    {% endif %}

    <div class="blog-management-container">
        <header class="blog-header">
            <h1 class="blog-title">Blog Verwaltung</h1>
            <a href="{% url 'create_blog_post' %}" class="btn-new-post">
                <svg fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v16m8-8H4"></path>
                </svg>
                Neuer Blog-Beitrag
            </a>
        </header>

        {% if all_blogs %}
        <div class="blog-grid">
            {% for blog in all_blogs %}
            <article class="blog-card">
                {% if blog.image %}
                <img src="{{ blog.image.url }}" alt="{{ blog.image_alt_text|default:blog.title }}" class="blog-image">
                {% else %}
                <div class="blog-image-placeholder">
                    <svg fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"></path>
                    </svg>
                </div>
                {% endif %}
                
                <div class="blog-content">
                    <div class="blog-card-header">
                        <h2 class="blog-card-title">{{ blog.title }}</h2>
                        {% if blog.published %}
                        <span class="blog-status status-published">Veröffentlicht</span>
                        {% else %}
                        <span class="blog-status status-draft">Entwurf</span>
                        {% endif %}
                    </div>
                    
                    <div class="blog-meta">
                        {% if blog.category %}
                        <span class="blog-category">{{ blog.category.name }}</span>
                        {% endif %}
                        
                        <span class="blog-meta-item">
                            <svg fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"></path>
                            </svg>
                            {{ blog.date|date:"d.m.Y" }}
                        </span>
                        
                        {% if blog.author %}
                        <span class="blog-meta-item">
                            <svg fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"></path>
                            </svg>
                            {{ blog.author.first_name }} {{ blog.author.last_name }}
                        </span>
                        {% endif %}
                    </div>
                    
                    {% if blog.lead_paragraph or blog.meta_description %}
                    <p class="blog-excerpt">
                        {{ blog.lead_paragraph|default:blog.meta_description|truncatewords:25 }}
                    </p>
                    {% endif %}
                    
                    <div class="blog-actions">
                        <a href="post/{{blog.id}}/edit" class="blog-btn btn-edit">
                            Bearbeiten
                        </a>
                        <a href="/blog/{{blog.published_year}}/{{ blog.slug }}" target="_blank" class="blog-btn btn-view">
                            Ansehen
                        </a>
                    </div>
                </div>
            </article>
            {% endfor %}
        </div>
        {% else %}
        <div class="blog-empty">
            <svg fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 20H5a2 2 0 01-2-2V6a2 2 0 012-2h10a2 2 0 012 2v1m2 13a2 2 0 01-2-2V7m2 13a2 2 0 002-2V9a2 2 0 00-2-2h-2m-4-3H9M7 16h6M7 8h6v4H7V8z"></path>
            </svg>
            <h2>Noch keine Blog-Beiträge vorhanden</h2>
            <p>Erstellen Sie Ihren ersten Blog-Beitrag, um Ihre Geschichten und News mit der Community zu teilen.</p>
            <a href="{% url 'create_blog_post' %}" class="btn-new-post">
                <svg fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v16m8-8H4"></path>
                </svg>
                Ersten Beitrag erstellen
            </a>
        </div>
        {% endif %}
    </div>
</body>
</html>